<html>
<head>
</head>
<body>
	<!-- <button onclick="connect()">Connect</button> -->
	<h2>7-8 game</h2>
	<label>Name</label>
	<input type="text" id="name"/>
	<p> JOIN A ROOM</p>
	<label>Romm no.</label>
	<input type="text" id="room"/>
	<button onclick="join()" id = "join" >Join</button>
	<p> OR CREATE A NEW ROOM </p>
	<button onclick="create()" id = "create" >Create</button>
	<br>
	<button onclick="play()" id = "play" style = "display : none" >Play</button>

	<label> Cards </label>
	<textarea id = "cards" style = "width : 100%; height : 50px;" ></textarea>

	<label style = "display : none" id = "joker_label">Select Joker</label>
	<input type="text" id = "joker_text" style = "display : none"/>
	<p id = "joker_ex">(e.g S,H,C,D)</p>
	<button onclick="joker()" id = "joker_btn"  style = "display : none">Select</button>

	<label> Moves </label>
	<textarea id = "text" style = "width : 100%; height : 150px;" ></textarea>
	<script type="text/javascript">
		var client_socket = new WebSocket('ws://localhost:8080');
		var name = "";
		var room;
		var hands;
		var cards;
		var joker;
		function join() {
			name = document.getElementById("name").value;
			room = document.getElementById("room").value;
			data = {
				"name": name,
				"room": room,
				"type": "join"
			};
			document.getElementById("join").style.display = "none";
			document.getElementById("create").style.display = "none";
			client_socket.send(JSON.stringify(data));
		}
		function create(){
			name = document.getElementById("name").value;
			data = {
				"name": name,
				"type": "create"
			};
			document.getElementById("create").style.display = "none";
			document.getElementById("join").style.display = "none";
			client_socket.send(JSON.stringify(data));
		}

		function play(){
					data = {
						"name" : name,
						"room" : room,
						"type" : "play"
					};
					client_socket.send(JSON.stringify(data));
		}
		function joker() {
			joker = document.getElementById("joker_text").value;
			data = {
				"name" : name,
				"room" : room,
				"joker": joker,
				"type" : "joker"
			};
			client_socket.send(JSON.stringify(data));
			document.getElementById("joker_label").style.display = "none";
			document.getElementById("joker_text").style.display = "none";
			document.getElementById("joker_btn").style.display = "none";
			document.getElementById("joker_ex").style.display = "none";
		}
		client_socket.onmessage = function(event){
				var jsonObject = JSON.parse(event.data);
				document.getElementById("text").value += ( jsonObject.data + "\n");
				if (jsonObject.type == "join") {
						document.getElementById("play").style.display = "block";
						room = jsonObject.room;
				}
				else if ( jsonObject.type == "create" ) {
						room = jsonObject.room;
				}
				else if ( jsonObject.type == "play") {
					document.getElementById("play").style.display = "none";
					hands = jsonObject.hands;
					cards = jsonObject.cards;
					document.getElementById("cards").value = cards.slice(0,5);
					if (hands == 8){
						document.getElementById("joker_label").style.display = "block";
						document.getElementById("joker_text").style.display = "block";
						document.getElementById("joker_btn").style.display = "block";
						document.getElementById("joker_ex").style.display = "block";
					}
				}
				else if (jsonObject.type == "joker") {
					document.getElementById("cards").value = cards.slice(0,10);
					joker = jsonObject.joker;
				}
		}

	</script>
</body>

</html>
